{% extends "base_nexora.html" %}

{% block title %}Oferta Engine - NEXORA{% endblock %}

{% block extra_head %}
<style>
    /* ============================================
       OFERTA ENGINE UI - DESIGN PREMIUM
       ============================================ */
    .oferta-container {
        padding: var(--spacing-6);
        max-width: 1400px;
        margin: 0 auto;
    }

    .oferta-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-6);
    }

    .oferta-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
    }

    .oferta-title h1 {
        font-size: var(--text-2xl);
        font-weight: 700;
        color: var(--text-primary);
        margin: 0;
    }

    .oferta-title-icon {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--accent-primary), #7c3aed);
        border-radius: var(--radius-xl);
        color: var(--text-on-accent);
        font-size: var(--text-xl);
    }

    /* Score Principal */
    .oferta-score-main {
        background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-xl);
        padding: var(--spacing-8);
        text-align: center;
        margin-bottom: var(--spacing-6);
    }

    .score-circle {
        width: 180px;
        height: 180px;
        margin: 0 auto var(--spacing-4);
        position: relative;
    }

    .score-circle svg {
        transform: rotate(-90deg);
    }

    .score-circle-bg {
        fill: none;
        stroke: var(--fill-primary);
        stroke-width: 12;
    }

    .score-circle-fill {
        fill: none;
        stroke-width: 12;
        stroke-linecap: round;
        transition: stroke-dashoffset 1s ease;
    }

    .score-circle-fill.excellent { stroke: var(--accent-success); }
    .score-circle-fill.good { stroke: var(--accent-info); }
    .score-circle-fill.average { stroke: var(--accent-warning); }
    .score-circle-fill.poor { stroke: var(--accent-danger); }

    .score-circle-value {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
    }

    .score-circle-number {
        font-size: var(--text-4xl);
        font-weight: 700;
        color: var(--text-primary);
    }

    .score-circle-label {
        font-size: var(--text-sm);
        color: var(--text-secondary);
    }

    .score-description {
        font-size: var(--text-lg);
        color: var(--text-primary);
        margin-bottom: var(--spacing-2);
    }

    .score-subtitle {
        font-size: var(--text-sm);
        color: var(--text-secondary);
    }

    /* Grid de Análise */
    .oferta-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: var(--spacing-6);
        margin-bottom: var(--spacing-6);
    }

    /* Cards de Análise */
    .analysis-card {
        background-color: var(--bg-secondary);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-xl);
        padding: var(--spacing-6);
    }

    .analysis-card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-4);
        padding-bottom: var(--spacing-4);
        border-bottom: 1px solid var(--border-primary);
    }

    .analysis-card-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-2);
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--text-primary);
    }

    .analysis-card-title i {
        color: var(--accent-primary);
    }

    .analysis-card-score {
        display: flex;
        align-items: center;
        gap: var(--spacing-2);
        padding: var(--spacing-1) var(--spacing-3);
        border-radius: var(--radius-full);
        font-size: var(--text-sm);
        font-weight: 600;
    }

    .analysis-card-score.excellent {
        background-color: rgba(34, 197, 94, 0.1);
        color: var(--accent-success);
    }

    .analysis-card-score.good {
        background-color: rgba(59, 130, 246, 0.1);
        color: var(--accent-info);
    }

    .analysis-card-score.average {
        background-color: rgba(249, 115, 22, 0.1);
        color: var(--accent-warning);
    }

    .analysis-card-score.poor {
        background-color: rgba(239, 68, 68, 0.1);
        color: var(--accent-danger);
    }

    /* Métricas de Análise */
    .analysis-metrics {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-4);
    }

    .analysis-metric {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .analysis-metric-label {
        font-size: var(--text-sm);
        color: var(--text-secondary);
    }

    .analysis-metric-value {
        font-size: var(--text-sm);
        font-weight: 600;
        color: var(--text-primary);
    }

    .analysis-metric-bar {
        flex: 1;
        height: 6px;
        background-color: var(--fill-primary);
        border-radius: var(--radius-full);
        margin: 0 var(--spacing-4);
        overflow: hidden;
    }

    .analysis-metric-bar-fill {
        height: 100%;
        border-radius: var(--radius-full);
        transition: width 0.5s ease;
    }

    /* Preço Otimizado */
    .price-section {
        background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(124, 58, 237, 0.1));
        border: 1px solid var(--accent-primary);
        border-radius: var(--radius-xl);
        padding: var(--spacing-6);
        margin-bottom: var(--spacing-6);
    }

    .price-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-4);
    }

    .price-title {
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--text-primary);
    }

    .price-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-4);
    }

    @media (max-width: 768px) {
        .price-grid {
            grid-template-columns: 1fr;
        }
    }

    .price-card {
        background-color: var(--bg-secondary);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-4);
        text-align: center;
    }

    .price-card.recommended {
        border-color: var(--accent-success);
        background: linear-gradient(135deg, rgba(34, 197, 94, 0.05), rgba(34, 197, 94, 0.1));
    }

    .price-card-label {
        font-size: var(--text-xs);
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: var(--spacing-2);
    }

    .price-card.recommended .price-card-label {
        color: var(--accent-success);
    }

    .price-card-value {
        font-size: var(--text-2xl);
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: var(--spacing-1);
    }

    .price-card-desc {
        font-size: var(--text-xs);
        color: var(--text-tertiary);
    }

    /* Sugestões de Melhoria */
    .suggestions-section {
        background-color: var(--bg-secondary);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-xl);
        padding: var(--spacing-6);
        margin-bottom: var(--spacing-6);
    }

    .suggestions-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-4);
    }

    .suggestions-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-2);
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--text-primary);
    }

    .suggestions-title i {
        color: var(--accent-warning);
    }

    .suggestion-item {
        display: flex;
        align-items: flex-start;
        gap: var(--spacing-4);
        padding: var(--spacing-4);
        background-color: var(--bg-tertiary);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-lg);
        margin-bottom: var(--spacing-3);
    }

    .suggestion-item:last-child {
        margin-bottom: 0;
    }

    .suggestion-icon {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--fill-primary);
        border-radius: var(--radius-lg);
        color: var(--accent-primary);
        flex-shrink: 0;
    }

    .suggestion-content {
        flex: 1;
    }

    .suggestion-title {
        font-size: var(--text-sm);
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--spacing-1);
    }

    .suggestion-desc {
        font-size: var(--text-sm);
        color: var(--text-secondary);
        margin-bottom: var(--spacing-3);
    }

    .suggestion-impact {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-1);
        padding: var(--spacing-1) var(--spacing-2);
        background-color: rgba(34, 197, 94, 0.1);
        border-radius: var(--radius-sm);
        font-size: var(--text-xs);
        font-weight: 600;
        color: var(--accent-success);
    }

    .suggestion-actions {
        display: flex;
        gap: var(--spacing-2);
        flex-shrink: 0;
    }

    /* Comparação com Concorrentes */
    .competitors-section {
        background-color: var(--bg-secondary);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-xl);
        padding: var(--spacing-6);
    }

    .competitors-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-4);
    }

    .competitors-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-2);
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--text-primary);
    }

    .competitors-title i {
        color: var(--accent-info);
    }

    .competitor-table {
        width: 100%;
        border-collapse: collapse;
    }

    .competitor-table th {
        padding: var(--spacing-3);
        text-align: left;
        font-size: var(--text-xs);
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-bottom: 1px solid var(--border-primary);
    }

    .competitor-table td {
        padding: var(--spacing-3);
        font-size: var(--text-sm);
        color: var(--text-primary);
        border-bottom: 1px solid var(--border-primary);
    }

    .competitor-table tr:last-child td {
        border-bottom: none;
    }

    .competitor-table tr.highlight {
        background-color: rgba(79, 70, 229, 0.05);
    }

    .competitor-table tr.highlight td {
        font-weight: 600;
    }

    .competitor-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-1);
        padding: 2px 8px;
        border-radius: var(--radius-full);
        font-size: var(--text-xs);
        font-weight: 600;
    }

    .competitor-badge.you {
        background-color: rgba(79, 70, 229, 0.1);
        color: var(--accent-primary);
    }

    .competitor-badge.leader {
        background-color: rgba(34, 197, 94, 0.1);
        color: var(--accent-success);
    }

    /* Botões de Ação */
    .action-buttons {
        display: flex;
        gap: var(--spacing-3);
        margin-top: var(--spacing-6);
    }

    @media (max-width: 768px) {
        .action-buttons {
            flex-direction: column;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="oferta-container">
    <!-- Header -->
    <div class="oferta-header">
        <div class="oferta-title">
            <div class="oferta-title-icon">
                <i class="fas fa-gift"></i>
            </div>
            <div>
                <h1>Oferta Engine</h1>
                <p style="color: var(--text-secondary); font-size: var(--text-sm); margin: 0;">
                    Análise e otimização inteligente da sua oferta
                </p>
            </div>
        </div>
        <div class="hub-actions">
            <button class="btn-nexora btn-nexora-secondary">
                <i class="fas fa-history"></i> Histórico
            </button>
            <button class="btn-nexora btn-nexora-primary" onclick="analyzeOffer()">
                <i class="fas fa-sync-alt"></i> Reanalisar
            </button>
        </div>
    </div>

    <!-- Score Principal -->
    <div class="oferta-score-main">
        <div class="score-circle">
            <svg width="180" height="180">
                <circle class="score-circle-bg" cx="90" cy="90" r="78"></circle>
                <circle class="score-circle-fill excellent" cx="90" cy="90" r="78" 
                        stroke-dasharray="490" stroke-dashoffset="63" id="mainScoreCircle"></circle>
            </svg>
            <div class="score-circle-value">
                <div class="score-circle-number" id="mainScoreValue">87</div>
                <div class="score-circle-label">de 100</div>
            </div>
        </div>
        <div class="score-description">Sua oferta está <strong style="color: var(--accent-success);">Excelente</strong></div>
        <div class="score-subtitle">Baseado em 12 fatores de conversão analisados</div>
    </div>

    <!-- Grid de Análise -->
    <div class="oferta-grid">
        <!-- Proposta de Valor -->
        <div class="analysis-card">
            <div class="analysis-card-header">
                <div class="analysis-card-title">
                    <i class="fas fa-gem"></i> Proposta de Valor
                </div>
                <span class="analysis-card-score excellent">
                    <i class="fas fa-check-circle"></i> 92/100
                </span>
            </div>
            <div class="analysis-metrics">
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Clareza</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 95%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">95%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Diferenciação</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 88%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">88%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Relevância</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 92%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">92%</span>
                </div>
            </div>
        </div>

        <!-- Estrutura de Preço -->
        <div class="analysis-card">
            <div class="analysis-card-header">
                <div class="analysis-card-title">
                    <i class="fas fa-dollar-sign"></i> Estrutura de Preço
                </div>
                <span class="analysis-card-score good">
                    <i class="fas fa-check-circle"></i> 78/100
                </span>
            </div>
            <div class="analysis-metrics">
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Ancoragem</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 65%; background-color: var(--accent-warning);"></div>
                    </div>
                    <span class="analysis-metric-value">65%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Valor Percebido</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 82%; background-color: var(--accent-info);"></div>
                    </div>
                    <span class="analysis-metric-value">82%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Competitividade</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 88%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">88%</span>
                </div>
            </div>
        </div>

        <!-- Gatilhos Mentais -->
        <div class="analysis-card">
            <div class="analysis-card-header">
                <div class="analysis-card-title">
                    <i class="fas fa-brain"></i> Gatilhos Mentais
                </div>
                <span class="analysis-card-score excellent">
                    <i class="fas fa-check-circle"></i> 90/100
                </span>
            </div>
            <div class="analysis-metrics">
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Escassez</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 95%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">95%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Prova Social</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 88%; background-color: var(--accent-success);"></div>
                    </div>
                    <span class="analysis-metric-value">88%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Autoridade</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 85%; background-color: var(--accent-info);"></div>
                    </div>
                    <span class="analysis-metric-value">85%</span>
                </div>
            </div>
        </div>

        <!-- Garantias -->
        <div class="analysis-card">
            <div class="analysis-card-header">
                <div class="analysis-card-title">
                    <i class="fas fa-shield-alt"></i> Garantias
                </div>
                <span class="analysis-card-score average">
                    <i class="fas fa-exclamation-circle"></i> 72/100
                </span>
            </div>
            <div class="analysis-metrics">
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Clareza</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 80%; background-color: var(--accent-info);"></div>
                    </div>
                    <span class="analysis-metric-value">80%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Força</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 65%; background-color: var(--accent-warning);"></div>
                    </div>
                    <span class="analysis-metric-value">65%</span>
                </div>
                <div class="analysis-metric">
                    <span class="analysis-metric-label">Confiança</span>
                    <div class="analysis-metric-bar">
                        <div class="analysis-metric-bar-fill" style="width: 72%; background-color: var(--accent-warning);"></div>
                    </div>
                    <span class="analysis-metric-value">72%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Preço Otimizado -->
    <div class="price-section">
        <div class="price-header">
            <span class="price-title"><i class="fas fa-calculator"></i> Preço Otimizado pela IA</span>
        </div>
        <div class="price-grid">
            <div class="price-card">
                <div class="price-card-label">Preço Mínimo</div>
                <div class="price-card-value">R$ 147</div>
                <div class="price-card-desc">Margem de 45%</div>
            </div>
            <div class="price-card recommended">
                <div class="price-card-label">✨ Recomendado</div>
                <div class="price-card-value">R$ 197</div>
                <div class="price-card-desc">Melhor conversão</div>
            </div>
            <div class="price-card">
                <div class="price-card-label">Preço Premium</div>
                <div class="price-card-value">R$ 297</div>
                <div class="price-card-desc">Maior ticket</div>
            </div>
        </div>
    </div>

    <!-- Sugestões de Melhoria -->
    <div class="suggestions-section">
        <div class="suggestions-header">
            <div class="suggestions-title">
                <i class="fas fa-lightbulb"></i> Sugestões de Melhoria
            </div>
            <span style="color: var(--text-secondary); font-size: var(--text-sm);">
                3 oportunidades identificadas
            </span>
        </div>

        <div class="suggestion-item">
            <div class="suggestion-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="suggestion-content">
                <div class="suggestion-title">Adicionar Bônus de Urgência</div>
                <div class="suggestion-desc">
                    Incluir um bônus exclusivo para compras nas próximas 24 horas pode aumentar significativamente a taxa de conversão.
                </div>
                <span class="suggestion-impact">
                    <i class="fas fa-arrow-up"></i> +15% conversão estimada
                </span>
            </div>
            <div class="suggestion-actions">
                <button class="btn-nexora btn-nexora-primary btn-sm">
                    <i class="fas fa-check"></i> Aplicar
                </button>
            </div>
        </div>

        <div class="suggestion-item">
            <div class="suggestion-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <div class="suggestion-content">
                <div class="suggestion-title">Fortalecer Garantia</div>
                <div class="suggestion-desc">
                    Aumentar o período de garantia de 7 para 30 dias e destacar "Risco Zero" na oferta.
                </div>
                <span class="suggestion-impact">
                    <i class="fas fa-arrow-up"></i> +12% conversão estimada
                </span>
            </div>
            <div class="suggestion-actions">
                <button class="btn-nexora btn-nexora-primary btn-sm">
                    <i class="fas fa-check"></i> Aplicar
                </button>
            </div>
        </div>

        <div class="suggestion-item">
            <div class="suggestion-icon">
                <i class="fas fa-tag"></i>
            </div>
            <div class="suggestion-content">
                <div class="suggestion-title">Melhorar Ancoragem de Preço</div>
                <div class="suggestion-desc">
                    Mostrar o preço original de R$ 497 antes do preço promocional para aumentar a percepção de valor.
                </div>
                <span class="suggestion-impact">
                    <i class="fas fa-arrow-up"></i> +8% conversão estimada
                </span>
            </div>
            <div class="suggestion-actions">
                <button class="btn-nexora btn-nexora-primary btn-sm">
                    <i class="fas fa-check"></i> Aplicar
                </button>
            </div>
        </div>
    </div>

    <!-- Comparação com Concorrentes -->
    <div class="competitors-section">
        <div class="competitors-header">
            <div class="competitors-title">
                <i class="fas fa-users"></i> Comparação com Concorrentes
            </div>
            <button class="btn-nexora btn-nexora-secondary btn-sm">
                <i class="fas fa-sync-alt"></i> Atualizar
            </button>
        </div>

        <table class="competitor-table">
            <thead>
                <tr>
                    <th>Concorrente</th>
                    <th>Preço</th>
                    <th>Garantia</th>
                    <th>Bônus</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody>
                <tr class="highlight">
                    <td>
                        <span class="competitor-badge you">Você</span>
                        Sua Oferta
                    </td>
                    <td>R$ 197</td>
                    <td>7 dias</td>
                    <td>3 bônus</td>
                    <td style="color: var(--accent-success); font-weight: 600;">87/100</td>
                </tr>
                <tr>
                    <td>
                        <span class="competitor-badge leader">Líder</span>
                        Concorrente A
                    </td>
                    <td>R$ 297</td>
                    <td>30 dias</td>
                    <td>5 bônus</td>
                    <td>92/100</td>
                </tr>
                <tr>
                    <td>Concorrente B</td>
                    <td>R$ 147</td>
                    <td>7 dias</td>
                    <td>2 bônus</td>
                    <td>75/100</td>
                </tr>
                <tr>
                    <td>Concorrente C</td>
                    <td>R$ 247</td>
                    <td>15 dias</td>
                    <td>4 bônus</td>
                    <td>81/100</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Botões de Ação -->
    <div class="action-buttons">
        <button class="btn-nexora btn-nexora-secondary" style="flex: 1;">
            <i class="fas fa-download"></i> Exportar Relatório
        </button>
        <button class="btn-nexora btn-nexora-primary" style="flex: 1;">
            <i class="fas fa-magic"></i> Aplicar Todas as Sugestões
        </button>
    </div>
</div>

<script>
function analyzeOffer() {
    // Animação de loading
    const scoreCircle = document.getElementById('mainScoreCircle');
    const scoreValue = document.getElementById('mainScoreValue');
    
    scoreValue.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
    scoreCircle.style.strokeDashoffset = '490';
    
    setTimeout(() => {
        // Simular nova análise
        const newScore = Math.floor(Math.random() * 15) + 80;
        const offset = 490 - (490 * newScore / 100);
        
        scoreCircle.style.strokeDashoffset = offset;
        scoreValue.textContent = newScore;
    }, 1500);
}

// Animação inicial
document.addEventListener('DOMContentLoaded', function() {
    const scoreCircle = document.getElementById('mainScoreCircle');
    scoreCircle.style.strokeDashoffset = '490';
    
    setTimeout(() => {
        scoreCircle.style.strokeDashoffset = '63';
    }, 500);
});
</script>
{% endblock %}
